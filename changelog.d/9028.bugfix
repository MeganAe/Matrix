Fix a longstanding bug where some caches could grow larger than configured.
