Add a configuration option that allows existing users to log in with OpenID Connect, and fix a type hints error. Contributed by @BBBSnowball and @OmmyZhang.
