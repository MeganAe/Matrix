Refactor and cleanup for SRV record lookup
