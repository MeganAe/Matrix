Fixed some antipattern issues to improve code quality.
