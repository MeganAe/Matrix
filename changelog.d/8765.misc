Consolidate logic between the OpenID Connect and SAML code.
