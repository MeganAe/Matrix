Refactor `password_auth_provider` support code.
