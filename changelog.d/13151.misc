Faster room joins: fix race in recalculation of current room state.
